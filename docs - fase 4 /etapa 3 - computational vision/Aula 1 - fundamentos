Guia da fonte
Este material educacional explora os fundamentos da visão computacional, focando inicialmente na estrutura técnica de uma imagem como um vetor tridimensional e na diversidade dos espaços de cores, como RGB, HSV e escala de cinza. O texto destaca que o principal desafio no treinamento de modelos de aprendizado de máquina é a escassez ou o desbalanceamento de dados, propondo o data augmentation como uma solução estratégica para ampliar artificialmente os datasets. Entre as técnicas apresentadas para gerar variabilidade e evitar o overfitting, destacam-se a inversão de eixos, o recorte, a rotação e as transformações afins, além de manipulações no campo das cores e ruídos. Por fim, o guia reforça a importância de aplicar essas modificações com critério, garantindo que o significado contextual da imagem seja preservado para que o modelo aprenda padrões coerentes com a realidade.

POS TECH
MACHINE LEARNING ENGINEERING
FASE 4 AULA 01 -
FUNDAMENTOS DE VISÃO COMPUTACIONAL
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
O QUE VEM POR AÍ?
.3
HANDS ON
4
SAIBA MAIS
5
O QUE VOCÊ VIU NESTA AULA?
12
REFERÊNCIAS.
13
SUMÁRIO
FIAP
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Página 2 de 15
Fundamentos de Visão Computacional
O QUE VEM POR AÍ?
Página 3 de 15
Quando você precisa treinar qualquer modelo de aprendizado de máquina, o principal problema que surgirá é a base de dados (o dataset, ou o conjunto de treinamento). Para um modelo de processamento de imagens isso é particularmente mais complexo, devido ao tamanho de cada exemplo e a variância intrínseca deste tipo de dado. A obtenção e o armazenamento desse tipo de dado demandam recursos computacionais extensos. Ao mesmo tempo, marcar imagens é trabalhoso, complexo e propenso a interpretações.
Como podemos ter um dataset completo, que englobe o maior número de variações dos dados possíveis, sem que isso necessite de uma quantidade expressiva de trabalho? A utilização de técnicas de transformações de imagens ajuda, já que amplia a base da dados virtualmente, auxiliando a adicionar variância à base e reduzir o desbalanceamento entre as classes. Assim, vamos aprender um pouco o que é o Data Augmentation para o problema de Visão Computacional.
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
HANDS ON
Página 4 de 15
Nesta aula, vamos entender primeiro o que seria exatamente uma imagem, passando por espaços de cores. Depois, veremos as principais técnicas de data augmentation, além de abordarmos um dos cuidados que devemos tomar para não exagerar no processo.
FIAP
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
SAIBA MAIS
Página 5 de 15
O que é uma imagem?
Uma imagem é um vetor tridimensional composto por dois componentes espaciais e um componente de "canais". Cada pixel, ou ponto da imagem, representa a projeção de um ponto do espaço real, ou virtual, sobre um plano.
Cada ponto, por sua vez, é composto por 1 ou mais valores separados em canais que representam a cor (necessário), a opacidade (imagens em png, por exemplo) e/ou a profundidade do ponto (imagens obtidas com o Kinect, da Microsoft - figura 1). Essas duas últimas nem sempre estão presentes.
Figura 1 Imagem obtida com o Kinect da Microsoft Fonte: Microsoft (2022)
-Z
A forma como as cores são representadas varia de acordo com o espaço de tonalidades. Um dos mais conhecidos é o RGB, que representa cada uma delas se baseando na adição de componentes que representam as cores Vermelha, Verde e Azul. Ele é um sistema de coordenadas cúbicas, no qual tem-se o Preto na origem.
A figura 2 foi criada a partir da extração dos componentes RGB da imagem à esquerda. Note que no ponto com a menor intensidade da cor, a imagem tende para o preto, enquanto no ponto de maior intensidade se observa a cor saturada.
PDF exclusivo para Geovana Godoy Viana - rm365544 geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
Página 6 de 15
Figura 2 - Extração de canais RGB Fonte: Elaborado pelo autor (2024)
Um outro sistema também muito conhecido é o HSV (de Hue, Saturation and Value), que representa as cores em um sistema de coordenadas cilíndricas. Aqui o Tom (Hue) é uma componente cíclica que representa a cor, a Saturação representa a intensidade da cor e o Valor representa o quão clara aquela cor é.
Outro espaço de cor muito importante é a Escala de Cinza. Ele é muito utilizado na detecção de bordas e objetos por converter três canais em apenas um, reduzindo assim para um terço o tamanho ocupado pela imagem. No entanto, essa conversão resulta em perda de informações e, portanto, não pode ser transformada de volta para o espaço de cores original.
Figura 3 - Escala de cinza Fonte: Elaborado pelo autor (2024)
Existem vários outros espaços de cores, cada um com uma aplicação diferente, como por exemplo o CYMK, usado em impressoras. Cada um desses espaços pode ser convertido em outro conforme a necessidade.
PDF exclusivo para Geovana Godoy Viana - rm365544 geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
Página 7 de 15
Dê uma pausa na sua leitura e faça uma busca rápida sobre o assunto. Recomendo esta página para começar. Observe que vários desses modelos foram criados a partir da necessidade de termos representações mais fiéis e reproduzíveis das cores.
Voltando para a nossa aula, imagine que você queira treinar um modelo, um classificador, por exemplo: usar imagens de ultrassonografia para detectar a presença de cistos; ou ainda usar fotografias para determinar se uma casa à venda possui algum problema estrutural. O primeiro problema que você vai enfrentar é a construção de um dataset.
Entre os vários problemas que se pode ter em um dataset, temos o desbalanceamento de classes, a baixa quantidade de imagens e a baixa variância das imagens; tudo isso pode levar ao super-ajuste (overfitting) do modelo treinado.
Para evitar isso, recomenda-se o uso de técnicas de data augmentation, que é a manipulação controlada das imagens, o que cria uma imagem similar a uma pré- existente. Isso gera variância das imagens, mas sempre conservando a marcação original.
Mas antes de começar, é comum que as imagens de um dataset passem por um pré-tratamento, em que todas elas são condicionadas para possuírem o mesmo tamanho, estarem no mesmo espaço de cores e para que os valores armazenados sejam normalizados de acordo com o espaço de cores (para estarem entre 0 e 1).
O primeiro método que vamos ver aqui é a inversão de eixos (vertical e/ou horizontal). O processo consiste em inverter o sistema de coordenadas, fazendo com que os valores mais próximos da origem naquele eixo fiquem mais distantes e vice- versa. O mais comum é a utilização da inversão horizontal, pois ela conserva contextos importantes em imagens; no caso o que está acima na imagem.
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
Página 8 de 15
Figura 4 - Inversões nos eixos Fonte: Elaborado pelo autor (2024)
Outra forma de data augmentation é o recorte: quando a imagem é maior do que o que será usado como input do modelo, costuma-se cortar a imagem para preservar suas proporções e qualidade. Esse método também pode ser usado cortando a mesma imagem em diversas posições e ângulos diferentes. Com isso, você consegue usar uma mesma imagem para gerar diversas outras.
A rotação é a próxima variação possível. No entanto deve-se tomar cuidado, pois dependendo do ângulo regiões vazias podem aparecer nas bordas da imagem. Então essa técnica é mais adequada para ser usada quando é possível recortar a imagem ou quando o fundo é bem definido, no caso de ser uma cor sólida.
Outra forma é a translação, que evita que o modelo entenda que o objeto em questão sempre aparece em uma mesma posição, como é comum em uma base de reconhecimento facial, na qual todas as regiões de interesse (rosto) estão centralizadas. Isso pode ser feito como uma forma de recorte, mas também é possível completar regiões "vazias" das imagens com uma reconstrução de fundo, uma cor sólida por exemplo, igual ao método de rotação.
PDF exclusivo para Geovana Godoy Viana - rm365544 geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
Página 9 de 15
Essas transformações podem ser feitas usando conceito de "transformações afim" (do inglês affine transformation). Nelas, se usa uma matriz de transformada, que representa os parâmetros de conversão, para converter um espaço de afinidades em outro, de forma que as relações entre os objetos permaneçam. Por exemplo: uma linha continua sendo uma linha após a transformação, e linhas paralelas continuam paralelas após a transformação. Note que isso é válido considerando o espaço de afinidades, que pode resultar em algo que visualmente não conserve as propriedades iniciais do espaço.
Um outro tipo de data augmentation mexe no espaço de cores da imagem, rebalanceando as cores, tornando-as mais vivas ou forçando tons cinzentos para forçar o modelo a entender que as cores podem variar entre os exemplos. Também pode-se alterar os contrastes da imagem por meio da obtenção de histogramas de cores, realçando e/ou ofuscando regiões.
Figura 5 - Alteração de cor Fonte: Elaborado pelo autor (2024)
Também é possível aplicar um filtro matricial sobre a imagem, chamado de kernel, tanto com o objetivo de ofuscar partes da imagem quanto realçar esses trechos. É menos comum ver aplicações que usam isso para data augmentation, mas ao mesmo tempo esses métodos são fortemente usados no tratamento de imagens, seja para esconder colagens ou para destacar regiões de interesse na imagem.
Outra forma é a adição de ruídos à imagem. Esses ruídos podem ser localizados, distribuídos uniformemente, baseados na composição de imagens ou na remoção de partes das imagens, entre outras possibilidades.
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
Input
Página 10 de 15
Linear Methods
Generalized
Figura 5 - Composição não linear de imagens Fonte: Shorten; Khoshgoftaar (2019)
Finalmente, também é possível combinar os métodos. Note, porém, que independentemente da técnica que for utilizada, não se deve aplicar um método que poderia apagar o significado, ou a interpretação, da imagem.
Por exemplo: em um modelo voltado para OCR (Optical Character Recognition, aplicado à leitura de documentos) não faz sentido a aplicação de inversão horizontal ou vertical das imagens, pois isso mudaria totalmente a interpretação de sequência e a relação entre as letras, ao mesmo tempo em que adiciona uma situação inexistente no mundo real ao problema. Por outro lado, a rotação faria todo o sentido, pois o documento pode ser apresentado no formato de imagem em ângulos diversos.
Agora, eu recomendo que você leia mais sobre o assunto: é possível começar pelo survey de Shorten e Khoshgoftaar (2019). Faça também o exercício de aplicar
PDF exclusivo para Geovana Godoy Viana - rm365544 geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
Página 11 de 15
esses métodos e gere um pequeno dataset, para fixar os conceitos apresentados. Recomendo o uso da biblioteca OpenCV, pois ela tem interfaces em C++, Java e Python. Se ficar com qualquer dúvida, assista novamente os vídeos desta aula, releia os textos complementares ou nos procure no Discord. Bons estudos!
FIAP
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
O QUE VOCÊ VIU NESTA AULA?
Página 12 de 15
Nessa aula, vimos que uma imagem é representada em um formato de tensor e que as cores podem ser representadas em diversos espaços de cores. Também vimos as formas mais comuns de se fazer data augmentation por meio de simples transformadas aplicadas sobre as imagens.
Nas próximas aulas, veremos a evolução dos métodos de Visão Computacional ao longo dos anos.
FIAP
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
REFERÊNCIAS
Página 13 de 15
JOBLOVE, G. H., Greenberg, D. Color spaces for computer graphics. SIGGRAPH '78: Proceedings of the 5th annual conference on Computer graphics and interactive techniques. 1978. Disponível em: <https://dl.acm.org/doi/10.1145/965139.807362>. Acesso em: 26 jul. 2024.
LUKAC, R.; PLATANIOTIS, K. Single-Sensor Camera Image Processing. Color Image Processing: Methods and Applications. 2006. Disponível em:
< https://www.researchgate.net/publication/253269938_Single- Sensor_Camera_Image_Processing>. Acesso em: 26 jul. 2024.
MICROSOFT. Kinect for
Windows. 2022.
Disponível em:
<https://learn.microsoft.com/en-us/windows/apps/design/devices/kinect-for-
windows>. Acesso em: 26 jul. 2024.
SHORTEN, C.; KHOSHGOFTAAR, T. M. A survey on Image Data Augmentation for Deep Learning. 2019. Disponível em: <https://journalofbigdata.springeropen.com/articles/10.1186/s40537-019-0197-0>. Acesso em: 26 jul. 2024.
WIKIPEDIA. List of color spaces and their uses. 2024. Disponível em: <https://en.wikipedia.org/wiki/List_of_color_spaces_and_their_uses>. Acesso em: 26 jul. 2024.
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Fundamentos de Visão Computacional
PALAVRAS-CHAVE
Visão Computacional. Espaço de Cores. Data Augmentation.
FIAI
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Página 14 de 15
POS TECH
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com