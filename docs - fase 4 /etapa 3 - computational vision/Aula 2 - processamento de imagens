Guia da fonte
Este material educativo explora técnicas fundamentais de processamento de imagens voltadas para a extração de informações e a identificação de objetos em datasets. O texto detalha métodos determinísticos como a segmentação de cores no espaço HSV, o uso de momentos para localização espacial e o refinamento de máscaras através de operações morfológicas de abertura e fechamento. Além disso, a aula aborda a detecção de bordas e a Transformada de Hough, culminando no modelo de classificação em cascata de Haar para o reconhecimento de padrões como faces e olhos. Em suma, a fonte apresenta ferramentas de visão computacional clássica que, embora anteriores às redes neurais profundas, permanecem valiosas por sua eficiência computacional em ambientes controlados ou dispositivos de baixo poder de processamento.

POS TECH
MACHINE LEARNING ENGINEERING
FASE 4 | AULA 02 -
PROCESSAMENTO DE IMAGENS
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
O QUE VEM POR AÍ?
HANDS ON
SAIBA MAIS
O QUE VOCÊ VIU NESTA AULA? REFERÊNCIAS.
SUMÁRIO
Página 2 de 15
FIAP
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
3
4
5
12
13
Processamento de Imagens
O QUE VEM POR AÍ?
Página 3 de 15
Anteriormente, aprendemos como as imagens são "vistas" pelo computador, além de como tratar essas imagens com o objetivo principal de criar um dataset. Mas um dataset sem uma aplicação não tem utilidade. Então, precisamos de um problema.
Imagine que você precise separar pimentões, que geralmente vêm em três cores: verde, amarelo e vermelho. Como você faria para automatizar esse processo?
Existem várias soluções possíveis para este problema. Podemos usar um processo de segmentação de cores, determinando as posições dos pimentões de acordo com as cores desejadas, ou treinar um modelo de classificação para isso. Vamos lá?
FIA
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
HANDS ON
Página 4 de 15
Nesta aula, veremos como utilizar os métodos de segmentação de cores e determinar a localização de objetos na imagem. Em seguida, aprenderemos como extrair os contornos de uma imagem e determinar linhas características nela.
Finalmente, vamos usar o método de classificação em cascata baseado em características de Haar, que é capaz de encontrar objetos na imagem em função de suas características.
FIAP
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
SAIBA MAIS
Página 5 de 15
Na última aula, estudamos os principais métodos de transformação de imagens. Vimos que eles são utilizados para alterar imagens para resolver problemas de balanceamento de dataset e de variância. Agora, vamos aprender a extrair informações das imagens.
A primeira técnica é a Segmentação de Cores. Ela consiste em separar as cores, ou um range de cores, com o objetivo de marcar regiões de interesse na imagem.
Primeiro, precisamos descobrir qual a faixa de cores de interesse. Isso é feito convertendo a imagem para o espaço de cores HSV, por ele representar as cores do mesmo tom em um formato retangular, facilitando o processo de segmentação. Você então, determina o retângulo que contém a cor que você deseja segmentar.
Então, para cada pixel, é só verificar se a cor está dentro do retângulo, gerando uma máscara. Essa máscara, então, pode ser usada para conversão aplicada sobre a imagem original, extraindo assim as regiões de interesse.
Figura 1
Imagem original e segmentando a laranja Fonte: Elaborado pelo autor (2024)
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
Página 6 de 15
Com a segmentação é possível utilizar diversos métodos para se determinar a posição dos objetos na imagem. Para fazer isso nós calculamos os momentos das imagens, o que é feito sobre a máscara, que contém a região de interesse. A partir daí, a posição X e Y do centro da máscara é calculado pela divisão dos momentos M10 e M01 pelo momento Moo, respectivamente.
Com isso é possível detectar um objeto na imagem (segmentação de cores) e apontar onde o objeto está na imagem (cálculo do centro da máscara). De forma semelhante você também pode determinar em qual região do espaço se encontra a região de interesse.
Figura 2 - Posição da laranja na imagem Fonte: Elaborado pelo autor (2024)
Existem, porém, alguns problemas com a segmentação. O primeiro deles é que não necessariamente um mesmo intervalo de cores funciona para imagens diferentes. As cores são fortemente afetadas por iluminação, qualidade da imagem, ângulo, entre outras coisas, então é muito difícil garantir que uma mesma máscara seja compatível entre imagens.
O segundo problema é que caso haja mais de um objeto na máscara é difícil fazer sua separação, principalmente se suas máscaras estão sobrepostas, menos ainda determinar individualmente o centro de cada uma.
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
Página 7 de 15
Figura 3 - Segmentando várias laranjas Fonte: Elaborado pelo autor (2024)
Também é possível que o método capture muitos artefatos que não são interessantes para nossos métodos, como no exemplo da figura 4. Nela é possível ver diversos artefatos marcados que possuem cores muito próximas à cor da laranja. Para combater esses problemas, podemos aplicar filtros que servem para expandir e reduzir a máscara.
Figura 4 - Segmentando laranja com muitos artefatos Fonte: Elaborado pelo autor (2024)
A Erosão é o método usado para reduzir os agrupamentos gerados pela máscara. O problema é que isso também reduz a máscara gerada em torno da nossa região de interesse. Para contornar isso, aplicamos em cima da nova máscara o
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
Página 8 de 15
método da Dilatação com o objetivo de reverter o efeito negativo causado pela erosão. Esse processo é chamado de Abertura e pode ser visto como um redutor de ruído.
Figura 5 - Ajustando a máscara com erosão e dilatação Fonte: Elaborado pelo autor (2024)
O inverso também pode ser feito: aplicar a Dilatação e depois a Erosão, o que corrigiria uma máscara com falhas internas na região de interesse. Esse processo é chamado de Fechamento.
A próxima técnica apresentada é a detecção de bordas em uma imagem. Para tanto, pode-se usar o algoritmo de detecção de bordas de Canny. A ideia é utilizar o filtro para detectar os pontos em que há variação das cores da imagem.
Figura 6 - Detecção de Bordas de Canny e Transformada de Hough Fonte: Elaborado pelo autor (2024)
A principal aplicação da detecção de bordas é realçar áreas de interesse. Em uma radiografia, por exemplo, pode-se usar o filtro de bordas para evidenciar
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
Página 9 de 15
possíveis rachaduras em um osso. Você também pode aplicar uma transformada de Hough sobre as bordas encontradas e usar isso para determinar retas características na imagem.
Agora, vamos explicar algumas vantagens do uso das técnicas apresentadas. Diferente do que começaremos a ver daqui para a frente, esses são métodos que podemos chamar de determinísticos ou algorítmicos. Eles lançam mão de métodos e procedimentos bem definidos para executar seus processos.
Se você conseguir usar uma técnica dessas para ajudar um agente autônomo a "ver o mundo é necessário tomar precauções, como manter o mínimo de variação possível em condições de iluminação. Além disso, essa ferramenta é ideal para situações em que se utiliza vídeo em plataformas com baixo poder computacional.
Um bom exemplo é a categoria Standard Platform da RoboCup. Essa competição consiste em um jogo de futebol com times compostos por diversos robôs. Nela, os robôs são padronizados e possuem recursos computacionais limitados, que devem ser utilizados para manter todas as funções paralelas executadas por eles.
Para os processos de localização e percepção dos jogadores de onde estão os demais jogadores e a bola, os robôs precisam se utilizar dos métodos apresentados, por serem métodos computacionalmente eficientes.
Agora, uma outra forma de extrair informações importantes de uma imagem é utilizando o método de classificação em cascatas baseado em características de Haar. Basicamente, ele funciona passando um conjunto de filtros sobre a imagem, anotando os locais em que cada um desses filtros obtém o maior valor. Então novos filtros são testados sobre os resultados do primeiro filtro e assim sucessivamente até o nível mais alto, que indica se um dado trecho da imagem é ou não parte do objeto esperado.
Esse é o primeiro modelo treinado aqui. Você precisa de uma base marcada na posição exata do objetivo e então um modelo aprende cascata de filtros, a qual precisa utilizar para classificar um objeto. Como o modelo busca apenas características de formato, é comum converter a imagem original para a escala de cinza e depois aplicar o método.
Também é possível realizar composição de filtros: na figura 7, por exemplo, foi utilizado um modelo pré-treinado para detectar faces. O retorno do modelo é um retângulo que contém a face. Dentro desse retângulo, então, aplicamos um modelo
PDF exclusivo para Geovana Godoy Viana - rm365544 geovana.godoy12@gmail.com
Processamento de Imagens
Página 10 de 15
pré-treinado para detectar olhos. Isso faz com que você adicione contexto ao modelo, impedindo o surgimento de falsos positivos.
Figura 7 - Detecção de Objetos com Haar Fonte: Elaborado pelo autor (2024)
Se por um lado esse método parece muito bom, por outro ele está longe de ser o melhor. Um dos grandes problemas desse, e de muitos outros modelos, é que ele é muito dependente dos dados de treinamento. A figura 8 mostra que o método só foi capaz de encontrar completamente uma face em outra imagem. O primeiro classificador foi capaz de encontrar três das quatro pessoas na imagem, mas não conseguiu encontrar o homem que está de lado.
Ao executarmos o segundo classificador, notamos que ele só encontrou os olhos da pessoa que está olhando para a frente; nem os olhos da pessoa de óculos nem os olhos da pessoa que está com o rosto mais abaixado foram percebidos pelo classificador. Muito provavelmente isso ocorreu devido a uma falta de imagens desses tipos nas bases de dados.
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
OLO CLUB
mo 00
0
Página 11 de 15
LO CLUB
0
Figura 8 - Problemas com a detecção do Haar Fonte: Elaborado pelo autor (2024)
Agora é com você: tente entender melhor o funcionamento dos métodos e tente imaginar como usar o que foi apresentado até aqui, incluindo os conceitos da primeira aula, para fazer projetos mais complexos. Um exemplo de projeto é determinar quais as frutas em uma cesta estão maduras.
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
O QUE VOCÊ VIU NESTA AULA?
Página 12 de 15
Nesta aula, vimos as técnicas de segmentação de cores, extração de bordas, obtenção de linhas de características e o classificador de Haar. Esses são os representantes da Visão Computacional antes do advento das redes convolucionais.
Eles eram muito utilizados pela falta de poder computacional da época e hoje são modelos ultrapassados, mas que ainda encontram serventia em problemas mais simples e ambientes controlados que podem pagar o trade-off de usar um modelo mais rápido, mas que ao mesmo tempo é inferior com relação à qualidade da resposta. Nas próximas aulas, vamos dar um salto para modelos mais atuais.
FIA
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
Página 13 de 15
REFERÊNCIAS
CANNY, J. A Computational Approach To Edge Detection. IEEE Transactions on Pattern Analysis and Machine Intelligence. 1986, p. 679-698.
MATAS, J.; GALAMBOS, C.; KITTLER, J. Robust detection of lines using the progressive probabilistic hough transform. Computer Vision and Image Understanding. 2000. p. 119-137.
MUKUNDAN, R.; RAMAKRISHNAN, K. R. Moment functions in image analysis: theory and applications. World scientific, 1998.
ROBOCUP SOCCER. Standard Platform. <https://www.robocup.org/leagues/5>. Acesso em: 26 jul. 2024.
2023.
Disponível em:
VIOLA, P.; JONES, M. Rapid object detection using a boosted cascade of simple features. Proceedings of the 2001 IEEE computer society conference on computer vision and pattern recognition. CVPR 2001. 2001.
FIR
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
Processamento de Imagens
PALAVRAS-CHAVE
Página 14 de 15
Segmentação de Cor. Filtro Canny. Transformada de Hough. Classificação em Cascata de Haar.
FIA
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com
POS TECH
PDF exclusivo para Geovana Godoy Viana - rm365544
geovana.godoy12@gmail.com