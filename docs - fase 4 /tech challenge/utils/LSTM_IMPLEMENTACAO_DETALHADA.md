# LSTM - ImplementaÃ§Ã£o Detalhada no Projeto

Este documento explica **como, onde e quando** cada componente do modelo LSTM Ã© implementado neste projeto. Conecta a teoria com o cÃ³digo real, mostrando exatamente o que acontece em cada etapa.

O documento inclui:
1 - VisÃ£o Geral da Estrutura do Projeto
2 - Mapa de Arquivos: O que cada um faz
3 - Fluxo Completo: Da coleta Ã  previsÃ£o
4 - Exemplo Real Passo a Passo
5 - Onde ficam os Pesos, PortÃµes e CÃ©lulas de MemÃ³ria
6 - Ciclo de Vida dos Dados
7 - FAQ de ImplementaÃ§Ã£o

---

## 1. VisÃ£o Geral da Estrutura do Projeto

### 1.1 Estrutura de Pastas

```
tech-challenge-lstm/
â”‚
â”œâ”€â”€ data/                          â† DADOS BRUTOS
â”‚   â””â”€â”€ data_PETR4_SA.csv           PreÃ§os histÃ³ricos baixados do yfinance
â”‚                                    (138 KB, ~1500 dias de dados)
â”‚
â”œâ”€â”€ models/                        â† ARTEFATOS TREINADOS
â”‚   â”œâ”€â”€ model_lstm.pth              Os PESOS aprendidos (130 KB)
â”‚   â”œâ”€â”€ scaler.pkl                  MinMaxScaler para normalizaÃ§Ã£o
â”‚   â”œâ”€â”€ config.pkl                  ConfiguraÃ§Ãµes do modelo
â”‚   â””â”€â”€ training_history.png        GrÃ¡fico de evoluÃ§Ã£o do treino
â”‚
â”œâ”€â”€ src/                           â† CÃ“DIGO-FONTE
â”‚   â”œâ”€â”€ data_collection.py          ETAPA 1: Baixar dados do yfinance
â”‚   â”œâ”€â”€ preprocessing.py            ETAPA 2: Normalizar e criar janelas
â”‚   â”œâ”€â”€ model.py                    ETAPA 3: Definir arquitetura LSTM
â”‚   â”œâ”€â”€ train.py                    ETAPA 4: Treinar o modelo
â”‚   â”œâ”€â”€ evaluate.py                 ETAPA 5: Avaliar mÃ©tricas (pendente)
â”‚   â””â”€â”€ app.py                      ETAPA 6: API FastAPI (pendente)
â”‚
â”œâ”€â”€ docs - fase 4/                 â† DOCUMENTAÃ‡ÃƒO
â”‚   â””â”€â”€ tech challenge/
â”‚       â”œâ”€â”€ REGRAS_DE_NEGOCIO.md
â”‚       â”œâ”€â”€ LSTM_ENTENDENDO_O_MODELO.md
â”‚       â”œâ”€â”€ MODELOS_ML_VISAO_GERAL.md
â”‚       â””â”€â”€ LSTM_IMPLEMENTACAO_DETALHADA.md  â† ESTE DOCUMENTO
â”‚
â”œâ”€â”€ Dockerfile                     â† ContainerizaÃ§Ã£o
â”œâ”€â”€ requirements.txt               â† DependÃªncias Python
â””â”€â”€ README.md                      â† VisÃ£o geral
```

### 1.2 Fluxo de ExecuÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        FLUXO DE EXECUÃ‡ÃƒO DO PROJETO                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   FASE DE DESENVOLVIMENTO (vocÃª executa uma vez)                            â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                           â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ data_collection  â”‚     â”‚  preprocessing   â”‚     â”‚     model        â”‚   â”‚
â”‚   â”‚      .py         â”‚â”€â”€â”€â”€â–¶â”‚      .py         â”‚â”€â”€â”€â”€â–¶â”‚      .py         â”‚   â”‚
â”‚   â”‚                  â”‚     â”‚                  â”‚     â”‚                  â”‚   â”‚
â”‚   â”‚ Baixa dados do   â”‚     â”‚ Normaliza e cria â”‚     â”‚ Define a         â”‚   â”‚
â”‚   â”‚ yfinance         â”‚     â”‚ janelas de 60    â”‚     â”‚ arquitetura      â”‚   â”‚
â”‚   â”‚                  â”‚     â”‚ dias             â”‚     â”‚ LSTM             â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚            â”‚                        â”‚                        â”‚              â”‚
â”‚            â–¼                        â–¼                        â–¼              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   data/          â”‚     â”‚   models/        â”‚     â”‚   (em memÃ³ria)   â”‚   â”‚
â”‚   â”‚  PETR4_SA.csv    â”‚     â”‚  scaler.pkl      â”‚     â”‚   Objeto model   â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  config.pkl      â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚              â”‚
â”‚                                                              â”‚              â”‚
â”‚                                                              â–¼              â”‚
â”‚                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚                                                    â”‚     train        â”‚    â”‚
â”‚                                                    â”‚      .py         â”‚    â”‚
â”‚                                                    â”‚                  â”‚    â”‚
â”‚                                                    â”‚ Treina 100       â”‚    â”‚
â”‚                                                    â”‚ Ã©pocas, ajusta   â”‚    â”‚
â”‚                                                    â”‚ pesos            â”‚    â”‚
â”‚                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚              â”‚
â”‚                                                             â–¼              â”‚
â”‚                                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚                                                    â”‚   models/        â”‚    â”‚
â”‚                                                    â”‚  model_lstm.pth  â”‚â—„â”€â”€ PESOS SALVOS!
â”‚                                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                             â”‚
â”‚   FASE DE PRODUÃ‡ÃƒO (usuÃ¡rios usam sempre que quiserem)                     â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                      â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   USUÃRIO        â”‚     â”‚      app         â”‚     â”‚   RESPOSTA       â”‚   â”‚
â”‚   â”‚                  â”‚â”€â”€â”€â”€â–¶â”‚      .py         â”‚â”€â”€â”€â”€â–¶â”‚                  â”‚   â”‚
â”‚   â”‚ Envia 60 preÃ§os  â”‚     â”‚                  â”‚     â”‚ PrevisÃ£o do      â”‚   â”‚
â”‚   â”‚ via API          â”‚     â”‚ Carrega .pth     â”‚     â”‚ prÃ³ximo dia      â”‚   â”‚
â”‚   â”‚                  â”‚     â”‚ Faz previsÃ£o     â”‚     â”‚                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Mapa de Arquivos: O que cada um faz

### 2.1 Arquivos de CÃ³digo (`src/`)

#### `data_collection.py` - Coleta de Dados

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ src/data_collection.py                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  O QUE FAZ:                                                                 â”‚
â”‚  â€¢ Baixa dados histÃ³ricos de aÃ§Ãµes usando yfinance                         â”‚
â”‚  â€¢ Salva em CSV para uso posterior                                         â”‚
â”‚                                                                             â”‚
â”‚  QUANDO EXECUTAR:                                                           â”‚
â”‚  â€¢ Uma vez, no inÃ­cio do projeto                                           â”‚
â”‚  â€¢ Novamente se quiser atualizar os dados                                  â”‚
â”‚                                                                             â”‚
â”‚  ENTRADA:                                                                   â”‚
â”‚  â€¢ SÃ­mbolo da aÃ§Ã£o (PETR4.SA)                                              â”‚
â”‚  â€¢ PerÃ­odo (2018-01-01 atÃ© 2024-01-01)                                     â”‚
â”‚                                                                             â”‚
â”‚  SAÃDA:                                                                     â”‚
â”‚  â€¢ data/data_PETR4_SA.csv (138 KB)                                         â”‚
â”‚                                                                             â”‚
â”‚  CÃ“DIGO PRINCIPAL:                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  df = yf.download("PETR4.SA", start="2018-01-01", end="2024-01-01")       â”‚
â”‚  df.to_csv("data/data_PETR4_SA.csv")                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### `preprocessing.py` - PrÃ©-processamento

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ src/preprocessing.py                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  O QUE FAZ:                                                                 â”‚
â”‚  1. Carrega o CSV                                                          â”‚
â”‚  2. Normaliza preÃ§os entre 0-1 (MinMaxScaler)                             â”‚
â”‚  3. Cria janelas de 60 dias (X) â†’ prÃ³ximo dia (y)                         â”‚
â”‚  4. Divide em treino (80%) e teste (20%)                                   â”‚
â”‚  5. Converte para tensores PyTorch                                         â”‚
â”‚                                                                             â”‚
â”‚  QUANDO EXECUTAR:                                                           â”‚
â”‚  â€¢ Chamado automaticamente pelo train.py                                   â”‚
â”‚  â€¢ Antes de qualquer treinamento                                           â”‚
â”‚                                                                             â”‚
â”‚  ENTRADA:                                                                   â”‚
â”‚  â€¢ data/data_PETR4_SA.csv                                                  â”‚
â”‚                                                                             â”‚
â”‚  SAÃDA:                                                                     â”‚
â”‚  â€¢ X_train, X_test, y_train, y_test (tensores em memÃ³ria)                 â”‚
â”‚  â€¢ models/scaler.pkl (para desnormalizar depois)                          â”‚
â”‚  â€¢ models/config.pkl (configuraÃ§Ãµes)                                       â”‚
â”‚                                                                             â”‚
â”‚  CÃ“DIGO PRINCIPAL:                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  # NormalizaÃ§Ã£o                                                             â”‚
â”‚  scaler = MinMaxScaler(feature_range=(0, 1))                               â”‚
â”‚  data_scaled = scaler.fit_transform(data)                                  â”‚
â”‚                                                                             â”‚
â”‚  # Criar janelas                                                            â”‚
â”‚  for i in range(len(data) - 60):                                           â”‚
â”‚      X.append(data[i:i+60])    # 60 dias de entrada                       â”‚
â”‚      y.append(data[i+60])      # dia 61 (target)                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### `model.py` - Arquitetura LSTM

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ src/model.py                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  O QUE FAZ:                                                                 â”‚
â”‚  â€¢ Define a classe StockLSTM (arquitetura da rede)                         â”‚
â”‚  â€¢ Configura: input_size=1, hidden_size=50, num_layers=2                  â”‚
â”‚                                                                             â”‚
â”‚  QUANDO EXECUTAR:                                                           â”‚
â”‚  â€¢ Importado pelo train.py para criar o modelo                             â”‚
â”‚  â€¢ Importado pelo app.py para carregar o modelo                            â”‚
â”‚                                                                             â”‚
â”‚  COMPONENTES DEFINIDOS:                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  self.lstm = nn.LSTM(...)   â† AQUI FICAM OS PORTÃ•ES!                      â”‚
â”‚  self.dropout = nn.Dropout(0.2)                                            â”‚
â”‚  self.linear = nn.Linear(50, 1)                                            â”‚
â”‚                                                                             â”‚
â”‚  ONDE ESTÃƒO OS PORTÃ•ES (forget, input, output)?                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  DENTRO do nn.LSTM do PyTorch!                                             â”‚
â”‚  VocÃª NÃƒO implementa manualmente - o PyTorch faz isso.                     â”‚
â”‚                                                                             â”‚
â”‚  CÃ“DIGO PRINCIPAL:                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                          â”‚
â”‚  class StockLSTM(nn.Module):                                                â”‚
â”‚      def __init__(self):                                                    â”‚
â”‚          self.lstm = nn.LSTM(                                               â”‚
â”‚              input_size=1,      # 1 feature (sÃ³ preÃ§o Close)              â”‚
â”‚              hidden_size=50,    # 50 neurÃ´nios por camada                 â”‚
â”‚              num_layers=2,      # 2 camadas empilhadas                    â”‚
â”‚              batch_first=True                                              â”‚
â”‚          )                                                                  â”‚
â”‚                                                                             â”‚
â”‚      def forward(self, x):                                                  â”‚
â”‚          lstm_out, (h_n, c_n) = self.lstm(x)  â† PORTÃ•ES EXECUTAM AQUI    â”‚
â”‚          #           â†‘    â†‘                                                â”‚
â”‚          #           â”‚    â””â”€â”€ cell state (memÃ³ria longo prazo)            â”‚
â”‚          #           â””â”€â”€â”€â”€â”€â”€â”€ hidden state (saÃ­da)                        â”‚
â”‚                                                                             â”‚
â”‚          last_output = lstm_out[:, -1, :]  # Pega Ãºltimo passo            â”‚
â”‚          prediction = self.linear(last_output)                             â”‚
â”‚          return prediction                                                  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### `train.py` - Treinamento

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ src/train.py                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  O QUE FAZ:                                                                 â”‚
â”‚  â€¢ Carrega dados prÃ©-processados                                           â”‚
â”‚  â€¢ Cria o modelo LSTM                                                      â”‚
â”‚  â€¢ Executa loop de treinamento (100 Ã©pocas)                                â”‚
â”‚  â€¢ Salva pesos treinados em .pth                                           â”‚
â”‚                                                                             â”‚
â”‚  QUANDO EXECUTAR:                                                           â”‚
â”‚  â€¢ Uma vez, apÃ³s coletar dados                                             â”‚
â”‚  â€¢ Novamente se quiser retreinar                                           â”‚
â”‚                                                                             â”‚
â”‚  ENTRADA:                                                                   â”‚
â”‚  â€¢ Dados prÃ©-processados (via preprocessing.py)                            â”‚
â”‚                                                                             â”‚
â”‚  SAÃDA:                                                                     â”‚
â”‚  â€¢ models/model_lstm.pth (130 KB) â† OS PESOS FICAM AQUI!                  â”‚
â”‚  â€¢ models/training_history.png                                             â”‚
â”‚                                                                             â”‚
â”‚  ONDE OS PESOS SÃƒO ATUALIZADOS?                                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                              â”‚
â”‚  No loop de treinamento:                                                    â”‚
â”‚                                                                             â”‚
â”‚  for epoch in range(100):                                                   â”‚
â”‚      # Forward pass (portÃµes executam)                                     â”‚
â”‚      outputs = model(X_train)                                              â”‚
â”‚      loss = criterion(outputs, y_train)                                    â”‚
â”‚                                                                             â”‚
â”‚      # Backward pass (pesos sÃ£o ajustados)                                 â”‚
â”‚      optimizer.zero_grad()                                                 â”‚
â”‚      loss.backward()       â† Calcula gradientes                           â”‚
â”‚      optimizer.step()      â† ATUALIZA PESOS AQUI!                         â”‚
â”‚                                                                             â”‚
â”‚  ONDE OS PESOS SÃƒO SALVOS?                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                   â”‚
â”‚  torch.save({                                                               â”‚
â”‚      'model_state_dict': model.state_dict(),  â† PESOS AQUI                â”‚
â”‚      'model_config': {...},                                                â”‚
â”‚      'train_losses': [...],                                                â”‚
â”‚      'val_losses': [...]                                                   â”‚
â”‚  }, 'models/model_lstm.pth')                                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Arquivos de Dados e Artefatos

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ARQUIVOS GERADOS PELO PROJETO                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ğŸ“‚ data/data_PETR4_SA.csv                                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                   â”‚
â”‚  â€¢ Tamanho: 138 KB                                                         â”‚
â”‚  â€¢ ConteÃºdo: ~1500 linhas de preÃ§os histÃ³ricos                            â”‚
â”‚  â€¢ Colunas: Date, Open, High, Low, Close, Adj Close, Volume               â”‚
â”‚  â€¢ Gerado por: data_collection.py                                          â”‚
â”‚  â€¢ Usado por: preprocessing.py                                             â”‚
â”‚                                                                             â”‚
â”‚  Exemplo de conteÃºdo:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚     Date     â”‚  Open  â”‚  High  â”‚  Low   â”‚ Close  â”‚ Volume  â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚ 2018-01-02   â”‚ 16.50  â”‚ 16.75  â”‚ 16.40  â”‚ 16.65  â”‚ 25M     â”‚           â”‚
â”‚  â”‚ 2018-01-03   â”‚ 16.70  â”‚ 16.90  â”‚ 16.60  â”‚ 16.85  â”‚ 30M     â”‚           â”‚
â”‚  â”‚ ...          â”‚ ...    â”‚ ...    â”‚ ...    â”‚ ...    â”‚ ...     â”‚           â”‚
â”‚  â”‚ 2023-12-28   â”‚ 37.20  â”‚ 37.50  â”‚ 37.00  â”‚ 37.35  â”‚ 15M     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“‚ models/model_lstm.pth                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                  â”‚
â”‚  â€¢ Tamanho: 130 KB                                                         â”‚
â”‚  â€¢ ConteÃºdo: Pesos treinados + configuraÃ§Ãµes + histÃ³rico                  â”‚
â”‚  â€¢ Gerado por: train.py                                                    â”‚
â”‚  â€¢ Usado por: app.py (API)                                                 â”‚
â”‚                                                                             â”‚
â”‚  O que estÃ¡ dentro:                                                         â”‚
â”‚  {                                                                          â”‚
â”‚    'model_state_dict': {         â† PESOS DA REDE (o que foi aprendido)    â”‚
â”‚      'lstm.weight_ih_l0': tensor([...]),   # Pesos inputâ†’hidden camada 0 â”‚
â”‚      'lstm.weight_hh_l0': tensor([...]),   # Pesos hiddenâ†’hidden camada 0â”‚
â”‚      'lstm.bias_ih_l0': tensor([...]),     # Bias camada 0               â”‚
â”‚      'lstm.bias_hh_l0': tensor([...]),                                    â”‚
â”‚      'lstm.weight_ih_l1': tensor([...]),   # Camada 1                    â”‚
â”‚      'lstm.weight_hh_l1': tensor([...]),                                  â”‚
â”‚      'lstm.bias_ih_l1': tensor([...]),                                    â”‚
â”‚      'lstm.bias_hh_l1': tensor([...]),                                    â”‚
â”‚      'linear.weight': tensor([...]),       # Camada de saÃ­da             â”‚
â”‚      'linear.bias': tensor([...])                                         â”‚
â”‚    },                                                                       â”‚
â”‚    'model_config': {             â† CONFIGURAÃ‡Ã•ES DA ARQUITETURA           â”‚
â”‚      'input_size': 1,                                                      â”‚
â”‚      'hidden_size': 50,                                                    â”‚
â”‚      'num_layers': 2,                                                      â”‚
â”‚      'dropout': 0.2                                                        â”‚
â”‚    },                                                                       â”‚
â”‚    'train_losses': [...],        â† HISTÃ“RICO (100 valores)                â”‚
â”‚    'val_losses': [...],                                                    â”‚
â”‚    'final_train_loss': 0.00123,                                            â”‚
â”‚    'final_val_loss': 0.00156                                               â”‚
â”‚  }                                                                          â”‚
â”‚                                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“‚ models/scaler.pkl                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                      â”‚
â”‚  â€¢ Tamanho: 719 bytes                                                      â”‚
â”‚  â€¢ ConteÃºdo: MinMaxScaler com min/max dos dados de treino                 â”‚
â”‚  â€¢ Gerado por: preprocessing.py                                            â”‚
â”‚  â€¢ Usado por: app.py (para normalizar entrada e desnormalizar saÃ­da)      â”‚
â”‚                                                                             â”‚
â”‚  Por que Ã© importante:                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Dados de treino: R$ 15.00 a R$ 45.00                                â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Para NORMALIZAR entrada do usuÃ¡rio:                                 â”‚   â”‚
â”‚  â”‚   valor_norm = (valor - 15) / (45 - 15)                            â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Para DESNORMALIZAR previsÃ£o:                                        â”‚   â”‚
â”‚  â”‚   valor_real = valor_norm Ã— (45 - 15) + 15                         â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚ Sem o scaler, nÃ£o conseguimos converter de volta para R$!          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                             â”‚
â”‚  ğŸ“‚ models/config.pkl                                                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                      â”‚
â”‚  â€¢ Tamanho: 130 bytes                                                      â”‚
â”‚  â€¢ ConteÃºdo: ConfiguraÃ§Ãµes de prÃ©-processamento                           â”‚
â”‚                                                                             â”‚
â”‚  {                                                                          â”‚
â”‚    'seq_length': 60,        # Janela de 60 dias                           â”‚
â”‚    'ticker': 'PETR4.SA',    # AÃ§Ã£o usada                                  â”‚
â”‚    'train_ratio': 0.8,      # 80% treino                                  â”‚
â”‚    'input_size': 1,         # SÃ³ Close                                    â”‚
â”‚    'n_train_samples': 1148, # Amostras de treino                          â”‚
â”‚    'n_test_samples': 288    # Amostras de teste                           â”‚
â”‚  }                                                                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Fluxo Completo: Da Coleta Ã  PrevisÃ£o

### 3.1 Diagrama Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLUXO COMPLETO DO PROJETO                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                    FASE 1: COLETA DE DADOS                            â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚    Internet (Yahoo Finance)                                                 â”‚
â”‚           â”‚                                                                 â”‚
â”‚           â”‚  yfinance.download()                                           â”‚
â”‚           â–¼                                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚    â”‚ data_collection â”‚                                                     â”‚
â”‚    â”‚      .py        â”‚                                                     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚             â”‚                                                               â”‚
â”‚             â”‚  df.to_csv()                                                 â”‚
â”‚             â–¼                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚    â”‚ data/           â”‚                                                     â”‚
â”‚    â”‚ PETR4_SA.csv    â”‚  â† 1500 dias de preÃ§os histÃ³ricos                  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                    FASE 2: PRÃ‰-PROCESSAMENTO                          â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚    â”‚ data/           â”‚                                                     â”‚
â”‚    â”‚ PETR4_SA.csv    â”‚                                                     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚             â”‚                                                               â”‚
â”‚             â”‚  pd.read_csv()                                               â”‚
â”‚             â–¼                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚ preprocessing   â”‚     â”‚  TRANSFORMAÃ‡Ã•ES:                        â”‚    â”‚
â”‚    â”‚      .py        â”‚â”€â”€â”€â”€â–¶â”‚  1. Pega sÃ³ coluna 'Close'              â”‚    â”‚
â”‚    â”‚                 â”‚     â”‚  2. Normaliza 0-1 (MinMaxScaler)        â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  3. Cria janelas [60 dias] â†’ [dia 61]   â”‚    â”‚
â”‚             â”‚              â”‚  4. Divide 80/20 treino/teste           â”‚    â”‚
â”‚             â”‚              â”‚  5. Converte para tensores PyTorch      â”‚    â”‚
â”‚             â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â”‚                                                               â”‚
â”‚             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚             â”‚                                    â”‚                         â”‚
â”‚             â–¼                                    â–¼                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    â”‚ X_train, y_trainâ”‚                 â”‚ models/         â”‚                â”‚
â”‚    â”‚ X_test, y_test  â”‚                 â”‚ scaler.pkl      â”‚                â”‚
â”‚    â”‚ (tensores)      â”‚                 â”‚ config.pkl      â”‚                â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚             â”‚                                                               â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                    FASE 3: DEFINIÃ‡ÃƒO DO MODELO                        â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚             â”‚                                                               â”‚
â”‚             â”‚  from model import create_model                              â”‚
â”‚             â–¼                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚    model        â”‚     â”‚  ARQUITETURA CRIADA:                    â”‚    â”‚
â”‚    â”‚      .py        â”‚â”€â”€â”€â”€â–¶â”‚  â€¢ nn.LSTM (2 camadas, 50 neurÃ´nios)   â”‚    â”‚
â”‚    â”‚                 â”‚     â”‚  â€¢ nn.Dropout (20%)                     â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â€¢ nn.Linear (50 â†’ 1)                  â”‚    â”‚
â”‚             â”‚              â”‚                                         â”‚    â”‚
â”‚             â”‚              â”‚  Pesos iniciais: ALEATÃ“RIOS             â”‚    â”‚
â”‚             â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â”‚                                                               â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                    FASE 4: TREINAMENTO                                â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚             â”‚                                                               â”‚
â”‚             â–¼                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚    train        â”‚     â”‚  LOOP DE TREINAMENTO (100 Ã©pocas):      â”‚    â”‚
â”‚    â”‚      .py        â”‚â”€â”€â”€â”€â–¶â”‚                                         â”‚    â”‚
â”‚    â”‚                 â”‚     â”‚  for epoch in range(100):               â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚      # Forward pass                     â”‚    â”‚
â”‚             â”‚              â”‚      outputs = model(X_train)           â”‚    â”‚
â”‚             â”‚              â”‚      loss = MSE(outputs, y_train)       â”‚    â”‚
â”‚             â”‚              â”‚                                         â”‚    â”‚
â”‚             â”‚              â”‚      # Backward pass                    â”‚    â”‚
â”‚             â”‚              â”‚      loss.backward()  â† Calcula grads   â”‚    â”‚
â”‚             â”‚              â”‚      optimizer.step() â† Atualiza pesos  â”‚    â”‚
â”‚             â”‚              â”‚                                         â”‚    â”‚
â”‚             â”‚              â”‚  Pesos finais: APRENDIDOS               â”‚    â”‚
â”‚             â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â”‚                                                               â”‚
â”‚             â”‚  torch.save()                                                â”‚
â”‚             â–¼                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚    â”‚ models/         â”‚                                                     â”‚
â”‚    â”‚ model_lstm.pth  â”‚  â† PESOS APRENDIDOS SALVOS AQUI!                   â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘                    FASE 5: INFERÃŠNCIA (API)                           â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚    â”‚ models/         â”‚                                                     â”‚
â”‚    â”‚ model_lstm.pth  â”‚                                                     â”‚
â”‚    â”‚ scaler.pkl      â”‚                                                     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚             â”‚                                                               â”‚
â”‚             â”‚  torch.load() / joblib.load()                                â”‚
â”‚             â–¼                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚    â”‚    app          â”‚     â”‚  PROCESSAMENTO DE REQUISIÃ‡ÃƒO:           â”‚    â”‚
â”‚    â”‚      .py        â”‚â”€â”€â”€â”€â–¶â”‚  1. Recebe 60 preÃ§os do usuÃ¡rio        â”‚    â”‚
â”‚    â”‚                 â”‚     â”‚  2. Normaliza com scaler               â”‚    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  3. Forward pass no modelo             â”‚    â”‚
â”‚             â”‚              â”‚  4. Desnormaliza resultado             â”‚    â”‚
â”‚             â”‚              â”‚  5. Retorna previsÃ£o em R$             â”‚    â”‚
â”‚             â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚             â”‚                                                               â”‚
â”‚             â–¼                                                               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                     â”‚
â”‚    â”‚ {"predicted_    â”‚                                                     â”‚
â”‚    â”‚  price": 43.29} â”‚  â† RESPOSTA AO USUÃRIO                             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Exemplo Real Passo a Passo

### 4.1 Dados Reais do Projeto

Vamos seguir o fluxo com nÃºmeros reais do projeto:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXEMPLO COM DADOS REAIS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  ETAPA 1: DADOS BRUTOS (data_collection.py)                                â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  Baixado do yfinance:                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚    Date    â”‚  Open  â”‚  High  â”‚  Low   â”‚ Close  â”‚                        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚
â”‚  â”‚ 2018-01-02 â”‚ 16.50  â”‚ 16.75  â”‚ 16.40  â”‚ 16.65  â”‚                        â”‚
â”‚  â”‚ 2018-01-03 â”‚ 16.70  â”‚ 16.90  â”‚ 16.60  â”‚ 16.85  â”‚                        â”‚
â”‚  â”‚ 2018-01-04 â”‚ 16.80  â”‚ 17.10  â”‚ 16.75  â”‚ 17.05  â”‚                        â”‚
â”‚  â”‚    ...     â”‚  ...   â”‚  ...   â”‚  ...   â”‚  ...   â”‚                        â”‚
â”‚  â”‚ 2023-12-27 â”‚ 37.10  â”‚ 37.45  â”‚ 36.90  â”‚ 37.20  â”‚                        â”‚
â”‚  â”‚ 2023-12-28 â”‚ 37.20  â”‚ 37.50  â”‚ 37.00  â”‚ 37.35  â”‚                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                                                                             â”‚
â”‚  Total: ~1500 dias                                                          â”‚
â”‚  Coluna usada: apenas 'Close'                                              â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  ETAPA 2: NORMALIZAÃ‡ÃƒO (preprocessing.py)                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  Antes (R$):     [16.65, 16.85, 17.05, ..., 37.20, 37.35]                  â”‚
â”‚                                                                             â”‚
â”‚  MinMaxScaler encontrou:                                                    â”‚
â”‚  â€¢ MÃ­nimo: R$ 15.00 (aprox)                                                â”‚
â”‚  â€¢ MÃ¡ximo: R$ 45.00 (aprox)                                                â”‚
â”‚                                                                             â”‚
â”‚  FÃ³rmula: norm = (valor - 15) / (45 - 15)                                  â”‚
â”‚                                                                             â”‚
â”‚  Depois (0-1):   [0.055, 0.062, 0.068, ..., 0.740, 0.745]                  â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  ETAPA 3: CRIAR JANELAS (preprocessing.py)                                 â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  SequÃªncia 1:                                                               â”‚
â”‚  X[0] = [dia1, dia2, dia3, ..., dia60]  â†’ y[0] = dia61                    â”‚
â”‚         [0.055, 0.062, 0.068, ..., 0.310]      [0.315]                     â”‚
â”‚                                                                             â”‚
â”‚  SequÃªncia 2:                                                               â”‚
â”‚  X[1] = [dia2, dia3, dia4, ..., dia61]  â†’ y[1] = dia62                    â”‚
â”‚         [0.062, 0.068, 0.072, ..., 0.315]      [0.320]                     â”‚
â”‚                                                                             â”‚
â”‚  ...                                                                        â”‚
â”‚                                                                             â”‚
â”‚  SequÃªncia 1436:                                                            â”‚
â”‚  X[1435] = [dia1376, ..., dia1435]  â†’ y[1435] = dia1436                   â”‚
â”‚            [0.710, ..., 0.740]              [0.745]                        â”‚
â”‚                                                                             â”‚
â”‚  Total de sequÃªncias: 1436                                                  â”‚
â”‚  Shape de X: (1436, 60, 1)                                                 â”‚
â”‚  Shape de y: (1436, 1)                                                     â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  ETAPA 4: DIVIDIR TREINO/TESTE (preprocessing.py)                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  80% para treino = 1148 sequÃªncias                                         â”‚
â”‚  20% para teste  = 288 sequÃªncias                                          â”‚
â”‚                                                                             â”‚
â”‚  X_train: (1148, 60, 1)   y_train: (1148, 1)                              â”‚
â”‚  X_test:  (288, 60, 1)    y_test:  (288, 1)                               â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  ETAPA 5: CRIAR MODELO (model.py)                                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  StockLSTM(                                                                 â”‚
â”‚    (lstm): LSTM(1, 50, num_layers=2, batch_first=True, dropout=0.2)       â”‚
â”‚    (dropout): Dropout(p=0.2)                                               â”‚
â”‚    (linear): Linear(in_features=50, out_features=1)                        â”‚
â”‚  )                                                                          â”‚
â”‚                                                                             â”‚
â”‚  Total de parÃ¢metros: ~42.000                                              â”‚
â”‚  Pesos iniciais: ALEATÃ“RIOS                                                â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  ETAPA 6: TREINAMENTO (train.py)                                           â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  Ã‰poca 1:    Train Loss: 0.089234 | Val Loss: 0.094521                     â”‚
â”‚  Ã‰poca 10:   Train Loss: 0.012453 | Val Loss: 0.015234                     â”‚
â”‚  Ã‰poca 50:   Train Loss: 0.002341 | Val Loss: 0.003456                     â”‚
â”‚  Ã‰poca 100:  Train Loss: 0.001234 | Val Loss: 0.001567                     â”‚
â”‚                                                                             â”‚
â”‚  Pesos finais: APRENDIDOS (salvos em model_lstm.pth)                       â”‚
â”‚                                                                             â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚  ETAPA 7: PREVISÃƒO (app.py - quando implementado)                          â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                                                                             â”‚
â”‚  UsuÃ¡rio envia: [36.42, 36.18, ..., 42.55, 42.82] (60 preÃ§os em R$)       â”‚
â”‚                                                                             â”‚
â”‚  1. Normaliza:  [0.714, 0.706, ..., 0.918, 0.927]                         â”‚
â”‚  2. Reshape:    (1, 60, 1)                                                 â”‚
â”‚  3. Forward:    model(input) â†’ 0.943 (normalizado)                        â”‚
â”‚  4. Desnorm:    0.943 Ã— 30 + 15 = R$ 43.29                                â”‚
â”‚                                                                             â”‚
â”‚  Resposta: {"predicted_price": 43.29}                                      â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Onde ficam os Pesos, PortÃµes e CÃ©lulas de MemÃ³ria

### 5.1 Mapa Completo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ONDE FICA CADA COMPONENTE DO LSTM                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘  PESOS (W, b) - PadrÃµes Aprendidos                                    â•‘ â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ONDE FICAM:                                                          â•‘ â”‚
â”‚  â•‘  ğŸ“ models/model_lstm.pth                                             â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  QUANDO SÃƒO CRIADOS:                                                  â•‘ â”‚
â”‚  â•‘  â€¢ Inicializados aleatoriamente em model.py (create_model)           â•‘ â”‚
â”‚  â•‘  â€¢ Ajustados durante train.py (optimizer.step)                       â•‘ â”‚
â”‚  â•‘  â€¢ Salvos apÃ³s treinamento (torch.save)                              â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  COMO ACESSAR:                                                        â•‘ â”‚
â”‚  â•‘  checkpoint = torch.load('models/model_lstm.pth')                    â•‘ â”‚
â”‚  â•‘  pesos = checkpoint['model_state_dict']                              â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  CONTEÃšDO:                                                            â•‘ â”‚
â”‚  â•‘  â€¢ lstm.weight_ih_l0: (200, 1)   # 4 gates Ã— 50 hidden Ã— 1 input    â•‘ â”‚
â”‚  â•‘  â€¢ lstm.weight_hh_l0: (200, 50)  # 4 gates Ã— 50 hidden Ã— 50 hidden  â•‘ â”‚
â”‚  â•‘  â€¢ lstm.bias_ih_l0:   (200,)     # 4 gates Ã— 50 hidden              â•‘ â”‚
â”‚  â•‘  â€¢ lstm.bias_hh_l0:   (200,)                                         â•‘ â”‚
â”‚  â•‘  â€¢ lstm.weight_ih_l1: (200, 50)  # Segunda camada                   â•‘ â”‚
â”‚  â•‘  â€¢ lstm.weight_hh_l1: (200, 50)                                      â•‘ â”‚
â”‚  â•‘  â€¢ lstm.bias_ih_l1:   (200,)                                         â•‘ â”‚
â”‚  â•‘  â€¢ lstm.bias_hh_l1:   (200,)                                         â•‘ â”‚
â”‚  â•‘  â€¢ linear.weight:     (1, 50)    # Camada de saÃ­da                  â•‘ â”‚
â”‚  â•‘  â€¢ linear.bias:       (1,)                                           â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘  PORTÃ•ES (Forget, Input, Output) - Controladores de MemÃ³ria          â•‘ â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ONDE FICAM:                                                          â•‘ â”‚
â”‚  â•‘  ğŸ“ src/model.py â†’ self.lstm = nn.LSTM(...)                          â•‘ â”‚
â”‚  â•‘  Implementados DENTRO do nn.LSTM do PyTorch                          â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  QUANDO EXECUTAM:                                                     â•‘ â”‚
â”‚  â•‘  â€¢ Toda vez que model(input) Ã© chamado (forward pass)                â•‘ â”‚
â”‚  â•‘  â€¢ Tanto no treinamento quanto na inferÃªncia                         â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  CÃ“DIGO QUE DISPARA:                                                  â•‘ â”‚
â”‚  â•‘  # Em model.py, linha 104                                            â•‘ â”‚
â”‚  â•‘  lstm_out, (h_n, c_n) = self.lstm(x)  â† PORTÃ•ES EXECUTAM AQUI       â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  O QUE ACONTECE INTERNAMENTE (vocÃª nÃ£o vÃª):                          â•‘ â”‚
â”‚  â•‘  f_t = sigmoid(W_f Ã— [h_{t-1}, x_t] + b_f)   # Forget               â•‘ â”‚
â”‚  â•‘  i_t = sigmoid(W_i Ã— [h_{t-1}, x_t] + b_i)   # Input                â•‘ â”‚
â”‚  â•‘  o_t = sigmoid(W_o Ã— [h_{t-1}, x_t] + b_o)   # Output               â•‘ â”‚
â”‚  â•‘  cÌƒ_t = tanh(W_c Ã— [h_{t-1}, x_t] + b_c)     # Candidato            â•‘ â”‚
â”‚  â•‘  c_t = f_t Ã— c_{t-1} + i_t Ã— cÌƒ_t            # Nova memÃ³ria         â•‘ â”‚
â”‚  â•‘  h_t = o_t Ã— tanh(c_t)                       # SaÃ­da                â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘  CÃ‰LULAS DE MEMÃ“RIA (h_t, c_t) - MemÃ³ria TemporÃ¡ria                  â•‘ â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ONDE FICAM:                                                          â•‘ â”‚
â”‚  â•‘  ğŸ§  NA MEMÃ“RIA RAM - durante execuÃ§Ã£o do forward pass                â•‘ â”‚
â”‚  â•‘  NÃƒO sÃ£o salvos em arquivo!                                          â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  QUANDO EXISTEM:                                                      â•‘ â”‚
â”‚  â•‘  â€¢ Criados quando model(input) Ã© chamado                             â•‘ â”‚
â”‚  â•‘  â€¢ Atualizados a cada passo temporal (dia 1, dia 2, ...)            â•‘ â”‚
â”‚  â•‘  â€¢ DestruÃ­dos quando a funÃ§Ã£o termina                                â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  CICLO DE VIDA:                                                       â•‘ â”‚
â”‚  â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘ â”‚
â”‚  â•‘  â”‚ def forward(self, x):                                           â”‚ â•‘ â”‚
â”‚  â•‘  â”‚     # h e c sÃ£o CRIADOS aqui (zerados ou pelo PyTorch)         â”‚ â•‘ â”‚
â”‚  â•‘  â”‚     lstm_out, (h_n, c_n) = self.lstm(x)                        â”‚ â•‘ â”‚
â”‚  â•‘  â”‚     #          â†‘    â†‘                                          â”‚ â•‘ â”‚
â”‚  â•‘  â”‚     #          â”‚    â””â”€â”€ c_n: cell state final                  â”‚ â•‘ â”‚
â”‚  â•‘  â”‚     #          â””â”€â”€â”€â”€â”€â”€â”€ h_n: hidden state final                â”‚ â•‘ â”‚
â”‚  â•‘  â”‚     ...                                                         â”‚ â•‘ â”‚
â”‚  â•‘  â”‚     return prediction                                           â”‚ â•‘ â”‚
â”‚  â•‘  â”‚ # h_n e c_n sÃ£o DESTRUÃDOS aqui (saem do escopo)               â”‚ â•‘ â”‚
â”‚  â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  SHAPE:                                                               â•‘ â”‚
â”‚  â•‘  â€¢ h_n: (num_layers, batch_size, hidden_size) = (2, 1, 50)          â•‘ â”‚
â”‚  â•‘  â€¢ c_n: (num_layers, batch_size, hidden_size) = (2, 1, 50)          â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Por que 200 nos pesos da LSTM?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              POR QUE lstm.weight TEM DIMENSÃƒO 200?                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  A LSTM tem 4 portÃµes, cada um com seus prÃ³prios pesos:                    â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  PortÃ£o        â”‚  Pesos necessÃ¡rios                                 â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  Input gate    â”‚  50 neurÃ´nios Ã— pesos                              â”‚   â”‚
â”‚  â”‚  Forget gate   â”‚  50 neurÃ´nios Ã— pesos                              â”‚   â”‚
â”‚  â”‚  Cell gate     â”‚  50 neurÃ´nios Ã— pesos                              â”‚   â”‚
â”‚  â”‚  Output gate   â”‚  50 neurÃ´nios Ã— pesos                              â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  TOTAL         â”‚  4 Ã— 50 = 200                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                             â”‚
â”‚  Por isso lstm.weight_ih_l0 tem shape (200, 1):                            â”‚
â”‚  â€¢ 200 = 4 gates Ã— 50 hidden_size                                          â”‚
â”‚  â€¢ 1 = input_size (sÃ³ o preÃ§o Close)                                       â”‚
â”‚                                                                             â”‚
â”‚  E lstm.weight_hh_l0 tem shape (200, 50):                                  â”‚
â”‚  â€¢ 200 = 4 gates Ã— 50 hidden_size                                          â”‚
â”‚  â€¢ 50 = hidden_size (conexÃµes do estado anterior)                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Ciclo de Vida dos Dados

### 6.1 Timeline de uma RequisiÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                TIMELINE DE UMA PREVISÃƒO (quando API estiver pronta)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  TEMPO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  â”‚
â”‚                                                                             â”‚
â”‚  t=0ms     API recebe requisiÃ§Ã£o                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚            POST /predict                                                    â”‚
â”‚            {"prices": [36.42, 36.18, ..., 42.82]}  (60 valores)           â”‚
â”‚                                                                             â”‚
â”‚  t=1ms     ValidaÃ§Ã£o                                                        â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚            âœ“ Verificar se tem 60 valores                                   â”‚
â”‚            âœ“ Verificar se sÃ£o nÃºmeros                                      â”‚
â”‚                                                                             â”‚
â”‚  t=2ms     NormalizaÃ§Ã£o                                                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚            scaler = joblib.load('models/scaler.pkl')                       â”‚
â”‚            prices_norm = scaler.transform(prices)                          â”‚
â”‚            [36.42, ...] â†’ [0.714, ...]                                    â”‚
â”‚                                                                             â”‚
â”‚  t=3ms     Reshape para tensor                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚            tensor = torch.FloatTensor(prices_norm)                         â”‚
â”‚            tensor = tensor.reshape(1, 60, 1)                               â”‚
â”‚                                                                             â”‚
â”‚  t=4ms     Forward pass (PORTÃ•ES EXECUTAM AQUI!)                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚            â”‚  h, c = zeros()  # MemÃ³ria inicializada                 â”‚    â”‚
â”‚            â”‚                                                          â”‚    â”‚
â”‚            â”‚  for dia in [1, 2, 3, ..., 60]:                         â”‚    â”‚
â”‚            â”‚      # Forget gate decide o que esquecer                â”‚    â”‚
â”‚            â”‚      # Input gate decide o que adicionar                â”‚    â”‚
â”‚            â”‚      # Cell state Ã© atualizado                          â”‚    â”‚
â”‚            â”‚      # Output gate decide o que mostrar                 â”‚    â”‚
â”‚            â”‚      h, c = lstm_cell(x[dia], h, c)                     â”‚    â”‚
â”‚            â”‚                                                          â”‚    â”‚
â”‚            â”‚  output = linear(h)  # 0.943 (normalizado)              â”‚    â”‚
â”‚            â”‚                                                          â”‚    â”‚
â”‚            â”‚  h, c sÃ£o DESTRUÃDOS aqui                               â”‚    â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                             â”‚
â”‚  t=8ms     DesnormalizaÃ§Ã£o                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚            prediction = scaler.inverse_transform(output)                   â”‚
â”‚            0.943 â†’ R$ 43.29                                                â”‚
â”‚                                                                             â”‚
â”‚  t=10ms    Resposta enviada                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                      â”‚
â”‚            {"predicted_price": 43.29}                                      â”‚
â”‚                                                                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                             â”‚
â”‚  PRÃ“XIMA REQUISIÃ‡ÃƒO (t=1000ms):                                            â”‚
â”‚  â€¢ h e c sÃ£o ZERADOS novamente                                             â”‚
â”‚  â€¢ Pesos permanecem os mesmos (carregados do .pth)                        â”‚
â”‚  â€¢ Processo repete do inÃ­cio                                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 O que Persiste e o que Ã© EfÃªmero

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PERSISTÃŠNCIA DOS COMPONENTES                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘  PERSISTENTE (salvo em arquivo, carregado uma vez)                    â•‘ â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ğŸ“ models/model_lstm.pth                                             â•‘ â”‚
â”‚  â•‘  â”œâ”€â”€ Pesos da LSTM (W_f, W_i, W_o, W_c, biases)                      â•‘ â”‚
â”‚  â•‘  â”œâ”€â”€ Pesos da Linear (W, b)                                          â•‘ â”‚
â”‚  â•‘  â””â”€â”€ ConfiguraÃ§Ãµes do modelo                                         â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ğŸ“ models/scaler.pkl                                                 â•‘ â”‚
â”‚  â•‘  â””â”€â”€ MinMaxScaler (min=15, max=45)                                   â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  Carregados quando API inicia:                                        â•‘ â”‚
â”‚  â•‘  model.load_state_dict(torch.load('model_lstm.pth'))                 â•‘ â”‚
â”‚  â•‘  scaler = joblib.load('scaler.pkl')                                  â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•— â”‚
â”‚  â•‘  EFÃŠMERO (criado e destruÃ­do a cada requisiÃ§Ã£o)                      â•‘ â”‚
â”‚  â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ğŸ§  Cell State (c_t)                                                  â•‘ â”‚
â”‚  â•‘  â”œâ”€â”€ Criado: inÃ­cio do forward pass                                  â•‘ â”‚
â”‚  â•‘  â”œâ”€â”€ Atualizado: a cada dia processado (1â†’60)                       â•‘ â”‚
â”‚  â•‘  â””â”€â”€ DestruÃ­do: fim da funÃ§Ã£o predict()                              â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ğŸ§  Hidden State (h_t)                                                â•‘ â”‚
â”‚  â•‘  â”œâ”€â”€ Criado: inÃ­cio do forward pass                                  â•‘ â”‚
â”‚  â•‘  â”œâ”€â”€ Atualizado: a cada dia processado (1â†’60)                       â•‘ â”‚
â”‚  â•‘  â””â”€â”€ DestruÃ­do: fim da funÃ§Ã£o predict()                              â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ğŸ“Š Tensor de entrada                                                 â•‘ â”‚
â”‚  â•‘  â”œâ”€â”€ Criado: ao receber requisiÃ§Ã£o                                   â•‘ â”‚
â”‚  â•‘  â””â”€â”€ DestruÃ­do: fim da funÃ§Ã£o predict()                              â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•‘  ğŸ“Š Tensor de saÃ­da                                                   â•‘ â”‚
â”‚  â•‘  â”œâ”€â”€ Criado: apÃ³s forward pass                                       â•‘ â”‚
â”‚  â•‘  â””â”€â”€ DestruÃ­do: apÃ³s enviar resposta                                 â•‘ â”‚
â”‚  â•‘                                                                       â•‘ â”‚
â”‚  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                             â”‚
â”‚  RESUMO:                                                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                                             â”‚
â”‚  â”‚              â”‚ Onde fica?     â”‚ Quando existe?    â”‚ Salvo em disco? â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ Pesos        â”‚ model_lstm.pth â”‚ Sempre            â”‚ âœ… Sim          â”‚  â”‚
â”‚  â”‚ Scaler       â”‚ scaler.pkl     â”‚ Sempre            â”‚ âœ… Sim          â”‚  â”‚
â”‚  â”‚ Cell State   â”‚ RAM            â”‚ Durante forward   â”‚ âŒ NÃ£o          â”‚  â”‚
â”‚  â”‚ Hidden State â”‚ RAM            â”‚ Durante forward   â”‚ âŒ NÃ£o          â”‚  â”‚
â”‚  â”‚ Input tensor â”‚ RAM            â”‚ Durante requisiÃ§Ã£oâ”‚ âŒ NÃ£o          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. FAQ de ImplementaÃ§Ã£o

### 7.1 Perguntas sobre Arquivos

**P: Por que o model_lstm.pth tem 130 KB se sÃ£o sÃ³ ~42.000 parÃ¢metros?**

R: AlÃ©m dos parÃ¢metros (nÃºmeros float32 = 4 bytes cada), o arquivo contÃ©m:
- Metadados do PyTorch
- HistÃ³rico de treinamento (200 valores de loss)
- ConfiguraÃ§Ãµes do modelo
- Overhead de serializaÃ§Ã£o

**P: Posso deletar o scaler.pkl?**

R: **NÃƒO!** Sem ele, vocÃª nÃ£o consegue:
- Normalizar entrada do usuÃ¡rio (mesma escala do treino)
- Desnormalizar a previsÃ£o (voltar para R$)

**P: Preciso do data_PETR4_SA.csv em produÃ§Ã£o?**

R: **NÃƒO.** O CSV sÃ³ Ã© necessÃ¡rio para treinamento. Em produÃ§Ã£o, vocÃª sÃ³ precisa:
- `model_lstm.pth` (pesos)
- `scaler.pkl` (normalizaÃ§Ã£o)

### 7.2 Perguntas sobre CÃ³digo

**P: Onde exatamente os portÃµes sÃ£o executados?**

R: Na linha 104 de `model.py`:
```python
lstm_out, (h_n, c_n) = self.lstm(x)
```
O `nn.LSTM` do PyTorch executa internamente todos os portÃµes para cada passo temporal.

**P: Onde os pesos sÃ£o atualizados no treinamento?**

R: Na linha 113 de `train.py`:
```python
optimizer.step()  # Atualiza todos os pesos baseado nos gradientes
```

**P: Por que o forward() nÃ£o mostra os portÃµes?**

R: Porque estÃ£o **encapsulados** dentro do `nn.LSTM`. O PyTorch abstrai essa complexidade. Se vocÃª quiser ver, teria que implementar uma LSTM manual (nÃ£o recomendado).

### 7.3 Perguntas sobre ExecuÃ§Ã£o

**P: Em que ordem devo executar os scripts?**

R:
```
1. python src/data_collection.py  # Baixa dados â†’ cria CSV
2. python src/preprocessing.py    # (opcional, train.py jÃ¡ chama)
3. python src/model.py            # (opcional, apenas testa arquitetura)
4. python src/train.py            # Treina e salva .pth
5. python src/app.py              # Inicia API (quando implementado)
```

**P: Quanto tempo leva o treinamento?**

R: Depende do hardware. Com CPU comum:
- ~1-2 segundos por Ã©poca
- ~100-200 segundos para 100 Ã©pocas

---

## 8. Resumo Executivo

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RESUMO DA IMPLEMENTAÃ‡ÃƒO                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ARQUIVOS IMPORTANTES:                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  â€¢ data/PETR4_SA.csv      â†’ Dados brutos (sÃ³ para treino)                 â”‚
â”‚  â€¢ models/model_lstm.pth  â†’ PESOS aprendidos (essencial!)                 â”‚
â”‚  â€¢ models/scaler.pkl      â†’ NormalizaÃ§Ã£o (essencial!)                     â”‚
â”‚  â€¢ src/model.py           â†’ Define arquitetura LSTM                        â”‚
â”‚  â€¢ src/train.py           â†’ Treina e salva pesos                          â”‚
â”‚                                                                             â”‚
â”‚  ONDE FICA CADA COISA:                                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                      â”‚
â”‚  â€¢ Pesos (W, b):          models/model_lstm.pth (permanente)              â”‚
â”‚  â€¢ PortÃµes:               Dentro de nn.LSTM (executam no forward)         â”‚
â”‚  â€¢ Cell/Hidden State:     RAM (temporÃ¡rio, a cada requisiÃ§Ã£o)             â”‚
â”‚                                                                             â”‚
â”‚  FLUXO DE EXECUÃ‡ÃƒO:                                                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                         â”‚
â”‚  TREINO:   CSV â†’ Normaliza â†’ Janelas â†’ Modelo â†’ Treina â†’ Salva .pth      â”‚
â”‚  API:      60 preÃ§os â†’ Normaliza â†’ Forward â†’ Desnormaliza â†’ R$            â”‚
â”‚                                                                             â”‚
â”‚  O QUE VOCÃŠ IMPLEMENTA vs O QUE O PYTORCH FAZ:                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                              â”‚
â”‚  VOCÃŠ:     Define arquitetura, prepara dados, chama forward                â”‚
â”‚  PYTORCH:  Implementa portÃµes, calcula gradientes, atualiza pesos         â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

*Documento gerado com base na implementaÃ§Ã£o real do projeto Tech Challenge LSTM - Fase 4*
